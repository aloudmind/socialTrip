<?xml version="1.0"?>
<project basedir="." default="compile">

    <taskdef name="jscomp" classname="com.google.javascript.jscomp.ant.CompileTask" classpath="${basedir}/build/google-compiler/compiler.jar"/>
    <target name="compile">
        <jscomp compilationLevel="simple" warning="verbose" debug="false" output="${basedir}/media/js/base.min.js">
            <sources dir="${basedir}/media/js">
		      <file name="main.js"/>
		      <file name="plugins.js"/>
		    </sources>
        </jscomp>
    </target>
  
    <!-- Compile .scss and .sass files in the public/sass directory using SASS -->
<target name="sass.compile">
  <property name="sass.dir" value="public/sass" />
  <property name="css.dir" value="public/css" />

  <apply executable="sass" dest="${css.dir}" verbose="true" force="true" failonerror="true">
    <arg value="--unix-newline" />
    <arg value="--compass" />
    <srcfile />
    <targetfile />
    <fileset dir="${sass.dir}" includes="**/*.scss,**/*.sass" excludes="**/_*" />
    <firstmatchmapper>
      <globmapper from="*.sass" to="*.css" />
      <globmapper from="*.scss" to="*.css" />
    </firstmatchmapper>
  </apply>
  <eclipse.refreshLocal resource="xa/public" depth="infinite"/>
</target>

<!-- Compile .scss files in the public/sass directory using Compass -->
  <target name="compass.compile">
    <exec executable="compass" dir="${basedir}/public/sass">
      <arg value="compile" />
    </exec>
    <eclipse.refreshLocal resource="xa/public" depth="infinite"/>
  </target>

</project>
